<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Remote Client (Standalone)</title>
    <link rel="stylesheet" href="style.css" />
    <style>
      /* CSS ri√™ng cho m√†n h√¨nh ƒëƒÉng nh·∫≠p */
      body {
        margin: 0;
      }
      #login-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: #222;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        color: #fff;
        transition: opacity 0.5s;
      }
      .login-box {
        background: #333;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
        width: 90%;
        max-width: 400px;
      }
      input.ip-input {
        width: 100%;
        padding: 12px;
        margin: 10px 0;
        background: #444;
        border: 1px solid #555;
        color: #fff;
        font-size: 16px;
      }
      .btn-connect {
        width: 100%;
        padding: 12px;
        background: #007bff;
        color: white;
        border: none;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
      }
      .history-list {
        margin-top: 15px;
        border-top: 1px solid #444;
        padding-top: 10px;
        max-height: 150px;
        overflow-y: auto;
        text-align: left;
      }
      .history-item {
        padding: 8px;
        background: #2a2a2a;
        margin-bottom: 5px;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
      }
      .history-item:hover {
        background: #444;
      }
      /* ·∫®n app ch√≠nh ban ƒë·∫ßu */
      #main-app {
        display: none;
      }
    </style>
  </head>
  <body>
    <div id="login-screen">
      <div class="login-box">
        <h2 style="text-align: center; margin-top: 0">üöÄ K·∫øt N·ªëi Server</h2>
        <div
          style="
            text-align: center;
            color: #ffc107;
            margin-bottom: 15px;
            font-family: monospace;
            font-size: 1.1em;
          "
        >
          ID M√°y: <span id="lblDeviceId">Loading...</span>
        </div>
        <label>ƒê·ªãa ch·ªâ IP Server:</label>
        <input
          type="text"
          id="ipInput"
          class="ip-input"
          placeholder="Nh·∫≠p IP Server (V√≠ d·ª•: 192.168.1.10)"
        />
        <button onclick="startConnection()" class="btn-connect">K·∫æT N·ªêI</button>

        <div class="history-list" id="historyList">
          <small style="color: #aaa">L·ªãch s·ª≠ ƒë·∫•u n·ªëi:</small>
          <div id="historyItems"></div>
        </div>
      </div>
    </div>

    <div id="main-app" class="container">
      <header>
        <h1>ƒêi·ªÅu khi·ªÉn m√°y t√≠nh t·ª´ xa</h1>
        <div id="client-info" class="client-info">ƒêang k·∫øt n·ªëi...</div>
      </header>

      <div class="tabs-scroll">
        <div class="tabs" onmouseleave="UI.handleTabLeave()">
          <button
            class="tab-btn active"
            onclick="UI.showTab('apps')"
            onmouseenter="UI.handleTabHover(this)"
          >
            üñ•Ô∏è ·ª®ng d·ª•ng
          </button>
          <button
            class="tab-btn"
            onclick="UI.showTab('procs')"
            onmouseenter="UI.handleTabHover(this)"
          >
            ‚öôÔ∏è Ti·∫øn tr√¨nh
          </button>
          <button
            class="tab-btn"
            onclick="UI.showTab('screen')"
            onmouseenter="UI.handleTabHover(this)"
          >
            üì∏ M√†n h√¨nh
          </button>
          <button
            class="tab-btn"
            onclick="UI.showTab('keylog')"
            onmouseenter="UI.handleTabHover(this)"
          >
            ‚å®Ô∏è B·∫Øt ph√≠m
          </button>
          <button
            class="tab-btn"
            onclick="UI.showTab('cam')"
            onmouseenter="UI.handleTabHover(this)"
          >
            üìπ Camera
          </button>
          <button
            class="tab-btn"
            onclick="UI.showTab('sys')"
            onmouseenter="UI.handleTabHover(this)"
          >
            üîå H·ªá th·ªëng
          </button>
          <div id="tab-slider"></div>
        </div>
      </div>

      <div id="tab-apps" class="tab-content active">
        <div class="card">
          <h3>M·ªü ·ª®ng D·ª•ng</h3>
          <div class="control-row">
            <input id="cmdApp" type="text" placeholder="T√™n (vd: chrome)..." />
            <button
              onclick="Apps.startCmd('cmdApp', 'statusApp')"
              class="btn-primary"
            >
              M·ªü ngay
            </button>
          </div>
          <div id="statusApp" class="status"></div>
          <div id="recentApps" class="recent-list">
            <small>G·∫ßn ƒë√¢y:</small>
            <div id="recentListTags"></div>
          </div>
        </div>
        <div class="card full-height">
          <div class="card-head">
            <h3>C·ª≠a S·ªï ƒêang M·ªü</h3>
            <button onclick="Apps.loadApps()" class="btn-refresh">
              üîÑ T·∫£i l·∫°i
            </button>
          </div>
          <input
            id="searchApps"
            class="search-box"
            placeholder="üîç L·ªçc..."
            oninput="UI.filterTable('appsTable', 0, this.value)"
          />
          <div class="table-wrapper">
            <table id="appsTable">
              <thead>
                <tr>
                  <th>T√™n ·ª©ng d·ª•ng & Ti√™u ƒë·ªÅ</th>
                  <th width="80">H√†nh ƒë·ªông</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>

      <div id="tab-procs" class="tab-content">
        <div class="card">
          <h3>Ch·∫°y Process</h3>
          <div class="control-row">
            <input id="cmdProc" type="text" placeholder="T√™n process..." />
            <button
              onclick="Apps.startCmd('cmdProc', 'statusProc')"
              class="btn-primary"
            >
              Ch·∫°y
            </button>
          </div>
          <div id="statusProc" class="status"></div>
        </div>
        <div class="card full-height">
          <div class="card-head">
            <h3>Danh S√°ch Process</h3>
            <button onclick="Procs.loadProcs()" class="btn-refresh">
              üîÑ T·∫£i l·∫°i
            </button>
          </div>
          <input
            id="searchProcs"
            class="search-box"
            placeholder="üîç L·ªçc..."
            oninput="UI.filterTable('procTable', 1, this.value)"
          />
          <div class="table-wrapper">
            <table id="procTable">
              <thead>
                <tr>
                  <th width="80">PID</th>
                  <th>T√™n File</th>
                  <th width="80">H√†nh ƒë·ªông</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>

      <div id="tab-screen" class="tab-content">
        <div class="card">
          <div class="control-row">
            <button onclick="Screen.updateScreen(true)" class="btn-primary">
              üì∏ Ch·ª•p & L∆∞u
            </button>
            <label>
              <input
                type="checkbox"
                id="autoShot"
                onchange="Screen.toggleAutoShot(this)"
              />
              T·ª± ƒë·ªông (2s)
            </label>
          </div>
          <div class="screen-box">
            <img id="screenImg" src="" alt="Ch∆∞a c√≥ ·∫£nh" />
          </div>
        </div>

        <div class="card">
          <div class="card-head">
            <h3>Th∆∞ Vi·ªán ·∫¢nh (Cache)</h3>
            <button onclick="Screen.clearGallery()" class="btn-danger">
              X√≥a t·∫•t c·∫£
            </button>
          </div>
          <div id="gallery" class="gallery-grid"></div>
        </div>

        <div class="card">
          <h3>üñ•Ô∏è Livestream M√†n H√¨nh (~33 FPS)</h3>
          <div class="control-row" style="justify-content: center">
            <button
              id="btnToggleScreenStream"
              onclick="Screen.toggleScreenStream(this)"
              class="btn-primary"
              style="min-width: 150px"
            >
              ‚ñ∂Ô∏è B·∫≠t Stream
            </button>
          </div>
          <div
            id="screenStreamStatus"
            class="status"
            style="text-align: center"
          ></div>
          <div class="screen-box" style="background: #000; margin-top: 15px">
            <img
              id="screenStreamView"
              alt="B·∫•m 'B·∫≠t Stream' ƒë·ªÉ b·∫Øt ƒë·∫ßu"
              style="max-width: 100%; display: block"
            />
          </div>
        </div>
      </div>

      <div id="tab-keylog" class="tab-content">
        <div class="card">
          <div class="card-head">
            <h3>Nh·∫≠t K√Ω B√†n Ph√≠m</h3>
            <label class="keylog-toggle-label">
              <input
                type="checkbox"
                id="chkKeylog"
                onchange="Keylog.toggleKeylog(this)"
                class="keylog-toggle-cb"
              />
              <strong>B·∫Øt ph√≠m</strong>
            </label>
          </div>
          <textarea
            id="logArea"
            readonly
            placeholder="Tick v√†o √¥ tr√™n ƒë·ªÉ b·∫Øt ƒë·∫ßu ghi..."
          ></textarea>
          <div class="control-row" style="justify-content: flex-end">
            <button onclick="Keylog.clearLogs()" class="btn-danger">
              X√≥a Nh·∫≠t K√Ω
            </button>
          </div>
        </div>
      </div>

      <div id="tab-cam" class="tab-content">
        <div class="card">
          <h3>Quay Video (Ghi ra file)</h3>
          <div class="control-row" style="margin-bottom: 10px">
            <label for="camName" style="width: 100px">Camera:</label>
            <select id="camName" class="input-field"></select>
          </div>
          <div class="control-row" style="margin-bottom: 10px">
            <label for="audioName" style="width: 100px">Microphone:</label>
            <select id="audioName" class="input-field"></select>
          </div>
          <div
            class="control-row"
            style="justify-content: center; margin-bottom: 15px"
          >
            <button class="btn-refresh" onclick="Cam.loadDevices(true)">
              üîÑ T·∫£i L·∫°i Danh S√°ch Thi·∫øt B·ªã
            </button>
          </div>
          <div class="control-row">
            <div class="vid-duration-wrapper">
              <input
                type="number"
                id="vidDur"
                value="5"
                min="1"
                max="300"
                style="width: 70px; text-align: center"
              />
              <label>gi√¢y (T·ªëi ƒëa 300s)</label>
            </div>
            <button id="btnVid" onclick="Cam.recordVideo()" class="btn-primary">
              üî¥ QUAY
            </button>
          </div>
          <div id="vidStatus" class="status"></div>
        </div>

        <div class="card">
          <h3>üìπ Livestream Camera (~20 FPS)</h3>
          <p>Ch·ªçn thi·∫øt b·ªã t·ª´ danh s√°ch ·ªü tr√™n tr∆∞·ªõc khi b·∫•m B·∫≠t Stream.</p>
          <div class="control-row" style="justify-content: center">
            <button
              id="btnToggleCamStream"
              onclick="Cam.toggleCamStream(this)"
              class="btn-primary"
              style="min-width: 150px"
            >
              ‚ñ∂Ô∏è B·∫≠t Stream
            </button>
          </div>
          <div
            id="camStreamStatus"
            class="status"
            style="text-align: center"
          ></div>
          <div class="screen-box" style="background: #000; margin-top: 15px">
            <img
              id="camStreamView"
              alt="B·∫•m 'B·∫≠t Stream' ƒë·ªÉ b·∫Øt ƒë·∫ßu"
              style="max-width: 100%; display: block"
            />
          </div>
        </div>
        <div class="card">
          <div class="card-head">
            <h3>Th∆∞ Vi·ªán Video (Cache)</h3>
            <button onclick="Cam.clearVideos()" class="btn-danger">
              X√≥a h·∫øt
            </button>
          </div>
          <div id="vidGallery" class="gallery-grid"></div>
        </div>
      </div>

      <div id="tab-sys" class="tab-content">
        <div class="card warning-zone">
          <h3>‚ö†Ô∏è Khu V·ª±c Nguy Hi·ªÉm</h3>
          <div
            class="control-row"
            style="justify-content: center; margin-top: 20px"
          >
            <button
              onclick="Sys.sendPower('shutdown')"
              class="btn-danger big-btn"
            >
              üõë SHUTDOWN
            </button>
            <button
              onclick="Sys.sendPower('restart')"
              class="btn-refresh big-btn"
              style="background: #ffc107; color: #000"
            >
              üîÑ RESTART
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="project-info-box">
      <strong>Project web + app ƒëi·ªÅu khi·ªÉn m√°y t√≠nh t·ª´ xa:</strong><br />
      V√µ L√™ Gia Huy - 24122004 === L√™ B·∫£o Ph√∫c - 24122021 === Tr·∫ßn Xu√¢n B√°ch -
      24122028
    </div>

    <div id="actionLogContainer" class="action-log-container">
      <div class="action-log-header">
        <span>üìã Nh·∫≠t k√Ω thao t√°c</span>
        <button
          onclick="UI.toggleActionLog()"
          style="padding: 2px 6px; font-size: 12px"
        >
          _
        </button>
      </div>
      <div id="actionLogList" class="action-log-list"></div>
    </div>

    <script src="client-core.js"></script>
  </body>
</html>
