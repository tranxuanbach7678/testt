<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Remote Client (Standalone)</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="login-screen">
      <div class="login-box">
        <h2 style="text-align: center; margin-top: 0">üöÄ K·∫øt N·ªëi Server</h2>
        <div
          style="
            text-align: center;
            color: var(--primary);
            margin-bottom: 15px;
            font-family: monospace;
            font-size: 1.1em;
          "
        >
          ID M√°y: <span id="lblDeviceId">Loading...</span>
        </div>
        <label>ƒê·ªãa ch·ªâ IP Server:</label>
        <input
          type="text"
          id="ipInput"
          class="ip-input"
          placeholder="192.168.1.10"
        />
        <button onclick="startConnection()" class="btn-connect">K·∫æT N·ªêI</button>
        <div class="history-list" id="historyList">
          <small style="color: var(--text-muted)">L·ªãch s·ª≠ ƒë·∫•u n·ªëi:</small>
          <div id="historyItems"></div>
        </div>
      </div>
    </div>

    <div id="main-app" class="container">
      <header>
        <h1 style="display: inline-block">ƒêi·ªÅu khi·ªÉn m√°y t√≠nh t·ª´ xa</h1>
        <div
          style="float: right; display: flex; align-items: center; gap: 10px"
        >
          <button
            class="theme-toggle-btn"
            onclick="toggleTheme()"
            title="Chuy·ªÉn ch·∫ø ƒë·ªô S√°ng/T·ªëi"
          >
            üåó Mode
          </button>
          <div id="client-info" class="client-info" style="position: static">
            ƒêang k·∫øt n·ªëi...
          </div>
        </div>
        <div style="clear: both"></div>
      </header>

      <div class="tabs-scroll">
        <div class="tabs" onmouseleave="handleTabLeave()">
          <button
            class="tab-btn active"
            onclick="showTab('apps')"
            onmouseenter="handleTabHover(this)"
          >
            üñ•Ô∏è ·ª®ng d·ª•ng
          </button>
          <button
            class="tab-btn"
            onclick="showTab('procs')"
            onmouseenter="handleTabHover(this)"
          >
            ‚öôÔ∏è Ti·∫øn tr√¨nh
          </button>
          <button
            class="tab-btn"
            onclick="showTab('screen')"
            onmouseenter="handleTabHover(this)"
          >
            üì∏ M√†n h√¨nh
          </button>
          <button
            class="tab-btn"
            onclick="showTab('keylog')"
            onmouseenter="handleTabHover(this)"
          >
            ‚å®Ô∏è B·∫Øt ph√≠m
          </button>
          <button
            class="tab-btn"
            onclick="showTab('cam')"
            onmouseenter="handleTabHover(this)"
          >
            üìπ Camera
          </button>
          <button
            class="tab-btn"
            onclick="showTab('sys')"
            onmouseenter="handleTabHover(this)"
          >
            üîå H·ªá th·ªëng
          </button>
          <div id="tab-slider"></div>
        </div>
      </div>

      <div id="tab-apps" class="tab-content active">
        <div class="card">
          <h3>M·ªü ·ª®ng D·ª•ng</h3>
          <div class="control-row">
            <input id="cmdApp" type="text" placeholder="T√™n (vd: chrome)..." />
            <button
              onclick="startCmd('cmdApp', 'statusApp')"
              class="btn-primary"
            >
              M·ªü ngay
            </button>
          </div>
          <div id="statusApp" class="status"></div>
          <div id="recentApps" class="recent-list">
            <small>G·∫ßn ƒë√¢y:</small>
            <div id="recentListTags"></div>
          </div>
        </div>
        <div class="card full-height">
          <div class="card-head">
            <h3>C·ª≠a S·ªï ƒêang M·ªü</h3>
            <button onclick="loadApps()" class="btn-refresh">üîÑ T·∫£i l·∫°i</button>
          </div>
          <input
            id="searchApps"
            class="search-box"
            placeholder="üîç L·ªçc..."
            oninput="filterTable('appsTable', 0, this.value)"
          />
          <div class="table-wrapper">
            <table id="appsTable">
              <thead>
                <tr>
                  <th>T√™n ·ª©ng d·ª•ng & Ti√™u ƒë·ªÅ</th>
                  <th width="80">H√†nh ƒë·ªông</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>

      <div id="tab-procs" class="tab-content">
        <div class="card">
          <h3>Ch·∫°y Process</h3>
          <div class="control-row">
            <input id="cmdProc" type="text" placeholder="T√™n process..." />
            <button
              onclick="startCmd('cmdProc', 'statusProc')"
              class="btn-primary"
            >
              Ch·∫°y
            </button>
          </div>
          <div id="statusProc" class="status"></div>
        </div>
        <div class="card full-height">
          <div class="card-head">
            <h3>Danh S√°ch Process</h3>
            <button onclick="loadProcs()" class="btn-refresh">
              üîÑ T·∫£i l·∫°i
            </button>
          </div>
          <input
            id="searchProcs"
            class="search-box"
            placeholder="üîç L·ªçc..."
            oninput="filterTable('procTable', 1, this.value)"
          />
          <div class="table-wrapper">
            <table id="procTable">
              <thead>
                <tr>
                  <th width="80">PID</th>
                  <th>T√™n File</th>
                  <th width="80">H√†nh ƒë·ªông</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>

      <div id="tab-screen" class="tab-content">
        <div class="card">
          <div class="control-row">
            <button onclick="updateScreen(true)" class="btn-primary">
              üì∏ Ch·ª•p & L∆∞u
            </button>
            <label
              ><input
                type="checkbox"
                id="autoShot"
                onchange="toggleAutoShot(this)"
              />
              T·ª± ƒë·ªông (2s)</label
            >
          </div>
          <div class="screen-box">
            <img id="screenImg" src="" alt="Ch∆∞a c√≥ ·∫£nh" />
          </div>
        </div>
        <div class="card">
          <div class="card-head">
            <h3>Th∆∞ Vi·ªán ·∫¢nh (Cache)</h3>
            <button onclick="clearGallery()" class="btn-danger">
              X√≥a t·∫•t c·∫£
            </button>
          </div>
          <div id="gallery" class="gallery-grid"></div>
        </div>
        <div class="card">
          <h3>üñ•Ô∏è Livestream M√†n H√¨nh (~33 FPS)</h3>
          <div class="control-row" style="justify-content: center">
            <button
              id="btnToggleScreenStream"
              onclick="toggleScreenStream(this)"
              class="btn-primary"
              style="min-width: 150px"
            >
              ‚ñ∂Ô∏è B·∫≠t Stream M√†n H√¨nh
            </button>
          </div>
          <div
            id="screenStreamStatus"
            class="status"
            style="text-align: center"
          ></div>
          <div class="screen-box" style="margin-top: 15px">
            <img id="screenStreamView" alt="Stream ƒë√£ t·∫Øt." />
          </div>
        </div>
      </div>

      <div id="tab-keylog" class="tab-content">
        <div class="card">
          <div class="card-head">
            <h3>Nh·∫≠t K√Ω B√†n Ph√≠m</h3>
            <label class="keylog-toggle-label">
              <input
                type="checkbox"
                id="chkKeylog"
                onchange="toggleKeylog(this)"
                class="keylog-toggle-cb"
              />
              <strong>B·∫Øt ph√≠m</strong>
            </label>
          </div>
          <textarea
            id="logArea"
            readonly
            placeholder="Tick v√†o √¥ tr√™n ƒë·ªÉ b·∫Øt ƒë·∫ßu ghi..."
          ></textarea>
          <div class="control-row" style="justify-content: flex-end">
            <button onclick="clearLogs()" class="btn-danger">
              X√≥a Nh·∫≠t K√Ω
            </button>
          </div>
        </div>
      </div>

      <div id="tab-cam" class="tab-content">
        <div class="card">
          <h3>Quay Video (Ghi ra file)</h3>
          <div class="control-row" style="margin-bottom: 10px">
            <label for="camName" style="width: 100px">Camera:</label>
            <select id="camName" class="input-field"></select>
          </div>
          <div
            class="control-row"
            style="justify-content: center; margin-bottom: 15px"
          >
            <button class="btn-refresh" onclick="loadDevices(true)">
              üîÑ T·∫£i L·∫°i Danh S√°ch Thi·∫øt B·ªã
            </button>
          </div>
          <hr style="border: 0; border-top: 1px solid #eee; margin: 15px 0" />
          <div
            class="control-row"
            style="justify-content: center; gap: 20px; margin-bottom: 15px"
          >
            <label style="cursor: pointer"
              ><input
                type="radio"
                name="recMode"
                value="timer"
                checked
                onchange="toggleRecMode()"
              />
              ‚è±Ô∏è H·∫πn gi·ªù</label
            >
            <label style="cursor: pointer"
              ><input
                type="radio"
                name="recMode"
                value="manual"
                onchange="toggleRecMode()"
              />
              üñêÔ∏è Th·ªß c√¥ng</label
            >
          </div>
          <div
            class="control-row"
            id="timerInputRow"
            style="justify-content: center"
          >
            <div class="vid-duration-wrapper">
              <label>Th·ªùi l∆∞·ª£ng:</label>
              <input
                type="number"
                id="vidDur"
                value="10"
                min="1"
                max="300"
                style="width: 70px; text-align: center"
              />
              <label>gi√¢y</label>
            </div>
          </div>
          <div class="control-row" style="justify-content: center">
            <button
              id="btnVid"
              onclick="recordVideo()"
              class="btn-primary"
              style="min-width: 200px"
            >
              üî¥ B·∫ÆT ƒê·∫¶U QUAY
            </button>
          </div>
          <div id="vidStatus" class="status" style="text-align: center"></div>
        </div>

        <div class="card">
          <h3>üìπ Livestream Camera (~20 FPS)</h3>
          <div class="control-row" style="justify-content: center; gap: 10px">
            <button
              id="btnToggleCamStream"
              onclick="toggleCamStream(this)"
              class="btn-primary"
              style="min-width: 150px"
            >
              ‚ñ∂Ô∏è B·∫≠t Stream
            </button>
            <button
              id="btnMute"
              onclick="toggleMute(this)"
              class="btn-warning"
              style="display: none"
            >
              üîä √Çm thanh: ON
            </button>
          </div>
          <div
            id="camStreamStatus"
            class="status"
            style="text-align: center"
          ></div>
          <div class="screen-box" style="background: #000; margin-top: 15px">
            <img
              id="camStreamView"
              alt="B·∫•m 'B·∫≠t Stream' ƒë·ªÉ b·∫Øt ƒë·∫ßu"
              style="max-width: 100%; display: block"
            />
          </div>
        </div>
        <div class="card">
          <div class="card-head">
            <h3>Th∆∞ Vi·ªán Video (Cache)</h3>
            <button onclick="clearVideos()" class="btn-danger">X√≥a h·∫øt</button>
          </div>
          <div id="vidGallery" class="gallery-grid"></div>
        </div>
      </div>

      <div id="tab-sys" class="tab-content">
        <div class="card warning-zone">
          <h3>‚ö†Ô∏è Khu V·ª±c Nguy Hi·ªÉm</h3>
          <div
            class="control-row"
            style="justify-content: center; margin-top: 20px"
          >
            <button onclick="sendPower('shutdown')" class="btn-danger big-btn">
              üõë SHUTDOWN
            </button>
            <button
              onclick="sendPower('restart')"
              class="btn-refresh big-btn"
              style="background: #ffc107; color: #000"
            >
              üîÑ RESTART
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="project-info-box">
      <strong>Project web + app ƒëi·ªÅu khi·ªÉn m√°y t√≠nh t·ª´ xa</strong><br />
      V√µ L√™ Gia Huy - 24122004 === L√™ B·∫£o Ph√∫c - 24122021 === Tr·∫ßn Xu√¢n B√°ch -
      24122028
    </div>

    <div id="actionLogContainer" class="action-log-container">
      <div class="action-log-header">
        <span>üìã Nh·∫≠t k√Ω thao t√°c</span>
        <button
          onclick="toggleActionLog()"
          style="padding: 2px 6px; font-size: 12px"
        >
          _
        </button>
      </div>
      <div id="actionLogList" class="action-log-list"></div>
    </div>

    <div id="confirmModal" class="modal-overlay" style="display: none">
      <div class="modal-box">
        <h3 id="confirmMsg">B·∫°n ch·∫Øc ch·∫Øn ch·ª©?</h3>
        <div class="modal-actions">
          <button id="btnConfirmYes" class="btn-primary">ƒê·ªíNG √ù</button>
          <button onclick="UI.closeConfirm()" class="btn-danger">H·ª¶Y</button>
        </div>
      </div>
    </div>
    <canvas id="camRecorderCanvas" style="display: none"></canvas>
    <script src="client-core.js"></script>
  </body>
</html>
